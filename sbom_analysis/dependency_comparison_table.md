# OPC UA 구현체 의존성 비교 테이블

## 📊 종합 비교표

### 표 1: 구현체별 의존성 개수 및 암호화 지원

| 구현체 | 버전 | 직접 의존성 | 간접 의존성 | 암호화 | 보안 점수 | 상태 |
|--------|------|------------|------------|--------|----------|------|
| **S2OPC** | v1.4.0 | 3 | ~5 | ✅ MbedTLS | 6/10 | ⚠️ 취약 |
| **S2OPC** | v1.6.0 | 3 | ~5 | ✅ MbedTLS | 8/10 | ✅ 패치 |
| **python-opcua** | v0.98.13 | 3 | ~8 | ❌ 없음 | 5/10 | 🔴 레거시 |
| **opcua-asyncio** | v1.1.8 | 9 | ~15 | ✅ crypto+SSL | 9/10 | 🟢 최신 |
| **open62541** | v1.3.8 | 4 | ~6 | ✅ MbedTLS | 6/10 | ⚠️ 취약 |
| **open62541** | v1.4.14 | 4 | ~6 | ✅ MbedTLS | 8/10 | ✅ 패치 |

---

### 표 2: 암호화 라이브러리 상세 비교

| 구현체 | 버전 | 암호화 라이브러리 | 버전 | TLS 지원 | 최신 표준 |
|--------|------|------------------|------|----------|----------|
| S2OPC | v1.4.0 | MbedTLS | 2.28.0 | ✅ TLS 1.2 | ⚠️ |
| S2OPC | v1.6.0 | MbedTLS | 2.28.0+ | ✅ TLS 1.2/1.3 | ✅ |
| python-opcua | v0.98.13 | ❌ 없음 | - | ❌ | ❌ |
| opcua-asyncio | v1.1.8 | cryptography + OpenSSL | 46.0.3 + 3.0.2 | ✅ TLS 1.3 | ✅ |
| open62541 | v1.3.8 | MbedTLS | 2.28.0 | ✅ TLS 1.2 | ⚠️ |
| open62541 | v1.4.14 | MbedTLS | 2.28.0+ | ✅ TLS 1.2/1.3 | ✅ |

---

### 표 3: Python 패키지 의존성 상세

| 패키지 | python-opcua | opcua-asyncio | 용도 | CVE 위험 |
|--------|-------------|---------------|------|----------|
| **lxml** | 6.0.2 | ❌ | XML 파싱 | ⚠️ 과거 CVE 多 |
| **python-dateutil** | 2.9.0 | 2.9.0 | 날짜 처리 | ✅ 안정 |
| **pytz** | 2025.2 | 2025.2 | 시간대 | ✅ 안정 |
| **cryptography** | ❌ | 46.0.3 | 암호화 | ✅ 최신 |
| **pyopenssl** | ❌ | 25.3.0 | OpenSSL | ✅ 최신 |
| **aiofiles** | ❌ | 25.1.0 | 비동기 I/O | ✅ 최신 |
| **aiosqlite** | ❌ | 0.21.0 | 비동기 DB | ✅ 최신 |
| **sortedcontainers** | ❌ | 2.4.0 | 자료구조 | ✅ 안정 |
| **typing-extensions** | ❌ | 4.15.0 | 타입 힌트 | ✅ 안정 |
| **wait-for2** | ❌ | 0.3.2 | 유틸리티 | ✅ 안정 |

**차이점**:
- python-opcua: 3개 (최소)
- opcua-asyncio: 9개 (풍부한 기능)
- 암호화: 없음 → 있음 (가장 큰 차이!)

---

### 표 4: C/C++ 라이브러리 의존성

| 라이브러리 | S2OPC v1.4.0 | S2OPC v1.6.0 | open62541 v1.3.8 | open62541 v1.4.14 | CVE 위험 |
|-----------|-------------|-------------|-----------------|------------------|----------|
| **MbedTLS** | 2.28.0 | 2.28.0+ | 2.28.0 | 2.28.0+ | ⚠️ 낮음 |
| **OpenSSL** | ❌ | ❌ | 선택 | 선택 | ⚠️ 낮음 |
| **libxml2** | 2.9.13 | 2.9.13 | ❌ | ❌ | ⚠️ 과거 CVE |
| **glibc** | 2.35 | 2.35 | 2.35 | 2.35 | ✅ 안정 |
| **ua-nodeset** | ❌ | ❌ | 필수 | 필수 | ✅ 안정 |

---

### 표 5: 의존성 업데이트 주기

| 구현체 | 마지막 업데이트 | 의존성 최신화 | 보안 패치 | 평가 |
|--------|---------------|-------------|----------|------|
| python-opcua v0.98.13 | 2020년 | ❌ 5년 전 | ❌ 없음 | 🔴 위험 |
| opcua-asyncio v1.1.8 | 2025년 | ✅ 2025년 | ✅ 지속 | 🟢 안전 |
| S2OPC v1.4.0 | 2022년 | ⚠️ 3년 전 | ⚠️ 중단 | 🟡 주의 |
| S2OPC v1.6.0 | 2024년 | ✅ 1년 전 | ✅ 지속 | 🟢 안전 |
| open62541 v1.3.8 | 2023년 | ⚠️ 2년 전 | ⚠️ 중단 | 🟡 주의 |
| open62541 v1.4.14 | 2024년 | ✅ 1년 전 | ✅ 지속 | 🟢 안전 |

---

### 표 6: 공급망 보안 리스크 매트릭스

| 리스크 요인 | python-opcua | opcua-asyncio | S2OPC v1.4.0 | S2OPC v1.6.0 | open62541 v1.3.8 | open62541 v1.4.14 |
|------------|-------------|---------------|-------------|-------------|-----------------|------------------|
| **암호화 미지원** | 🔴 | ✅ | ✅ | ✅ | ✅ | ✅ |
| **개발 중단** | 🔴 | ✅ | ⚠️ | ✅ | ⚠️ | ✅ |
| **의존성 CVE** | 🟡 | ✅ | ✅ | ✅ | ✅ | ✅ |
| **구버전 사용** | 🔴 | ✅ | 🔴 | ✅ | 🟡 | ✅ |
| **보안 패치** | 🔴 | ✅ | 🟡 | ✅ | 🟡 | ✅ |
| **커뮤니티** | 🔴 | ✅ | ✅ | ✅ | ✅ | ✅ |
| **총점** | 🔴 1/6 | ✅ 6/6 | 🟡 3/6 | ✅ 6/6 | 🟡 4/6 | ✅ 6/6 |

**범례**:
- 🔴 위험 (0점)
- 🟡 주의 (0.5점)
- ✅ 안전 (1점)

---

### 표 7: 업그레이드 영향 분석

| 구현체 | 업그레이드 | 의존성 변경 | 호환성 | 난이도 | 예상 시간 |
|--------|-----------|-----------|--------|--------|----------|
| python-opcua → asyncio | v0.98.13 → v1.1.8 | +6개 패키지 | ❌ API 변경 | 🔴 높음 | 1-2주 |
| S2OPC | v1.4.0 → v1.6.0 | 동일 | ✅ 호환 | 🟢 낮음 | 1-2일 |
| open62541 | v1.3.8 → v1.4.14 | 동일 | ✅ 호환 | 🟢 낮음 | 1-2일 |

---

## 10. SBOM 필드 매핑

### 10.1 CycloneDX Properties

각 구현체에 추가할 커스텀 속성:

```json
"properties": [
  {
    "name": "security:cisc2025:vulnerability-status",
    "value": "vulnerable|patched|secure"
  },
  {
    "name": "security:cisc2025:anonymous-auth",
    "value": "allowed|denied"
  },
  {
    "name": "security:cisc2025:nosecurity-policy",
    "value": "enabled|disabled"
  },
  {
    "name": "security:cisc2025:encryption-support",
    "value": "yes|no"
  },
  {
    "name": "security:cisc2025:last-patch-date",
    "value": "2025-09-05"
  },
  {
    "name": "security:cisc2025:risk-level",
    "value": "low|medium|high"
  },
  {
    "name": "security:cisc2025:upgrade-recommendation",
    "value": "urgent|recommended|optional"
  }
]
```

---

## 11. 요약

### 11.1 핵심 발견

1. **python-opcua의 심각한 리스크**:
   - 암호화 라이브러리 없음
   - 5년간 방치
   - 업그레이드 긴급

2. **opcua-asyncio의 우수성**:
   - 최신 암호화 (cryptography 46.0.3)
   - 모든 의존성 2024-2025년
   - 가장 안전한 선택

3. **C 구현체의 안정성**:
   - 최소 의존성 (3-4개)
   - MbedTLS 표준 사용
   - 패치 버전 권장

### 11.2 SBOM 기여

본 분석은 OPC UA 구현체의:
- ✅ 의존성 맵 제공
- ✅ CVE 매핑
- ✅ 리스크 정량화
- ✅ 업그레이드 가이드

를 SBOM 통합 가능한 형태로 제공합니다.

---

**작성일**: 2025-10-21  
**분석 도구**: pip, dpkg, CMake  
**참조**: CISC 2025 연구

