# 🎯 OPC UA Password Downgrade 공격 연구

## ✅ Step 1 완료: ANSSI PoC 분석

### 📋 분석 결과

**3개 서버 모두 분석 완료:**

| 서버 | 포트 | 보안 정책 | 인증 방식 | 취약점 |
|------|------|-----------|-----------|--------|
| S2OPC | 4840 | NoSecurity | Username/Password | ✅ 평문 전송 |
| Python opcua | 4841 | NoSecurity | Username/Password | ✅ 평문 전송 |
| open62541 | 4842 | NoSecurity | Username/Password | ✅ 평문 전송 |

### 🔍 발견된 취약점

**모든 서버가 NoSecurity 정책을 사용:**
- ⚠️  패스워드가 **평문**으로 전송됨
- ⚠️  네트워크 스니핑으로 즉시 탈취 가능
- ⚠️  Downgrade 공격 필요 없음 (이미 취약!)

## 🛠️ 생성된 도구

### Step 1: 패킷 분석기
```bash
cd /root/opcua-research/exploits
../python-opcua-env/bin/python step1_packet_analyzer.py
```

**기능:**
- GetEndpoints 요청/응답 분석
- 보안 정책 목록 확인
- 인증 방식 탐지
- Downgrade 공격 가능성 평가

## 📊 다음 단계

### Step 2: MITM 프록시 (예정)
- GetEndpoints 응답 조작
- 보안 정책 강등
- 패킷 재전송

### Step 3: 패스워드 스니핑 (예정)
- ActivateSession 메시지 캡처
- 평문 패스워드 추출
- 인증 정보 수집

### Step 4: 공격 시연 (예정)
- 전체 공격 체인 구현
- 자동화 스크립트
- 보고서 생성

## 💻 사용 방법

```bash
cd /root/opcua-research/exploits

# Step 1: 엔드포인트 분석
../python-opcua-env/bin/python step1_packet_analyzer.py

# Step 2-4는 구현 예정
```

## 📁 파일 구조

```
/root/opcua-research/exploits/
├── README.md                       ← 이 문서
├── PASSWORD_DOWNGRADE_ATTACK.md    ← 공격 개요
├── step1_packet_analyzer.py        ← ✅ Step 1 완료
├── step2_mitm_proxy.py             ← ⏳ 예정
├── step3_password_sniffer.py       ← ⏳ 예정
└── step4_full_attack.py            ← ⏳ 예정
```

## ⚠️ 법적 고지

**이 도구는 교육 및 연구 목적으로만 사용하세요:**
- ✅ 자신의 시스템에서만 테스트
- ✅ 허가받은 환경에서만 사용
- ❌ 무단 침투 테스트 금지
- ❌ 불법 사용 시 법적 책임

## 🎓 학습 목표

1. OPC UA 프로토콜 이해
2. 보안 정책 메커니즘 분석
3. 중간자 공격 원리 학습
4. 안전한 설정 방법 연구

---
작성일: $(date '+%Y-%m-%d %H:%M:%S')
진행 상태: Step 1 완료 ✅
다음 단계: Step 2 - MITM 프록시 구현
