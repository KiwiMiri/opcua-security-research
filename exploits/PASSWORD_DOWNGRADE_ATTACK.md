# OPC UA Password Downgrade ê³µê²©

## ðŸ“‹ ê³µê²© ê°œìš”

**Password Downgrade ê³µê²©**ì€ OPC UA ë³´ì•ˆ ë©”ì»¤ë‹ˆì¦˜ì˜ ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬
ê°•ë ¥í•œ ì¸ì¦ ë°©ì‹ì„ ì•½í•œ ë°©ì‹ìœ¼ë¡œ ê°•ë“±(downgrade)ì‹œí‚¤ëŠ” ê³µê²©ìž…ë‹ˆë‹¤.

## ðŸŽ¯ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤

### 1. ì •ìƒ ì¸ì¦ ê³¼ì •

```
í´ë¼ì´ì–¸íŠ¸                          ì„œë²„
    â”‚                                â”‚
    â”‚â”€â”€â”€â”€ GetEndpoints Request â”€â”€â”€â”€â”€>â”‚
    â”‚                                â”‚ 
    â”‚<â”€â”€â”€ Endpoints (ë³´ì•ˆ ì •ì±…ë“¤) â”€â”€â”€â”‚
    â”‚     - SignAndEncrypt           â”‚
    â”‚     - Sign                     â”‚
    â”‚     - None                     â”‚
    â”‚                                â”‚
    â”‚â”€â”€â”€â”€ CreateSession (Sign) â”€â”€â”€â”€â”€>â”‚
    â”‚                                â”‚
    â”‚<â”€â”€â”€ Session Created â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                                â”‚
    â”‚â”€â”€â”€â”€ ActivateSession â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚     (UserName + Password)      â”‚
    â”‚                                â”‚
    â”‚<â”€â”€â”€ Activated â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
```

### 2. Downgrade ê³µê²©

```
ê³µê²©ìž (ì¤‘ê°„ìž)              í´ë¼ì´ì–¸íŠ¸              ì„œë²„
    â”‚                          â”‚                    â”‚
    â”‚                          â”‚â”€â”€â”€ GetEndpoints â”€â”€>â”‚
    â”‚                          â”‚                    â”‚
    â”‚<â”€ Endpoints ê°€ë¡œì±„ê¸° â”€â”€â”€â”€â”‚<â”€â”€â”€â”€â”€â”€ Endpoints â”€â”€â”‚
    â”‚   (ë³´ì•ˆ ì •ì±… ìˆ˜ì •)        â”‚                    â”‚
    â”‚                          â”‚                    â”‚
    â”‚â”€â”€ Modified Endpoints â”€â”€â”€>â”‚                    â”‚
    â”‚   - Noneë§Œ ì‚¬ìš© ê°€ëŠ¥      â”‚                    â”‚
    â”‚                          â”‚                    â”‚
    â”‚                          â”‚â”€â”€â”€ CreateSession â”€>â”‚
    â”‚                          â”‚    (None ì •ì±…)     â”‚
    â”‚                          â”‚                    â”‚
    â”‚<â”€â”€â”€â”€ í‰ë¬¸ íŒ¨ìŠ¤ì›Œë“œ íƒˆì·¨! â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
```

## ðŸ”“ ì·¨ì•½ì  ë¶„ì„

### ì·¨ì•½í•œ ë²„ì „
- **open62541 < 1.3.9** - GetEndpoints ì‘ë‹µ ì¡°ìž‘ ê°€ëŠ¥
- **Python opcua < 0.98.14** - ë³´ì•ˆ ì •ì±… ê²€ì¦ ë¯¸í¡
- **S2OPC < 1.4.1** - ì •ì±… ê°•ì œ ë©”ì»¤ë‹ˆì¦˜ ë¶€ìž¬

### ê³µê²© ì¡°ê±´
1. âœ… ì¤‘ê°„ìž ê³µê²© ê°€ëŠ¥ (MITM)
2. âœ… ì„œë²„ê°€ NoSecurity ì •ì±… ì§€ì›
3. âœ… í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ì•ˆ ì •ì±… ìžë™ ì„ íƒ

## ðŸ› ï¸ PoC êµ¬í˜„ ë‹¨ê³„

### Step 1: ë„¤íŠ¸ì›Œí¬ ìŠ¤ë‹ˆí•‘
```python
# GetEndpoints ìš”ì²­/ì‘ë‹µ ìº¡ì²˜
# ë³´ì•ˆ ì •ì±… ëª©ë¡ í™•ì¸
```

### Step 2: MITM í”„ë¡ì‹œ êµ¬ì¶•
```python
# GetEndpoints ì‘ë‹µ ìˆ˜ì •
# NoSecurityë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ ì œê±°
```

### Step 3: íŒ¨ìŠ¤ì›Œë“œ íƒˆì·¨
```python
# ActivateSession ë©”ì‹œì§€ì—ì„œ í‰ë¬¸ íŒ¨ìŠ¤ì›Œë“œ ì¶”ì¶œ
```

## ðŸ“ íŒŒì¼ êµ¬ì¡°

```
/root/opcua-research/exploits/
â”œâ”€â”€ PASSWORD_DOWNGRADE_ATTACK.md  â† ì´ ë¬¸ì„œ
â”œâ”€â”€ password_downgrade_poc.py     â† PoC êµ¬í˜„ (ì˜ˆì •)
â”œâ”€â”€ mitm_proxy.py                 â† MITM í”„ë¡ì‹œ (ì˜ˆì •)
â””â”€â”€ packet_analyzer.py            â† íŒ¨í‚· ë¶„ì„ê¸° (ì˜ˆì •)
```

## ðŸŽ“ ë‹¤ìŒ ë‹¨ê³„

1. âœ… ANSSI PoC ë¬¸ì„œ ë¶„ì„
2. â³ ë„¤íŠ¸ì›Œí¬ íŒ¨í‚· ìº¡ì²˜ ë„êµ¬ ì„¤ì •
3. â³ MITM í”„ë¡ì‹œ êµ¬í˜„
4. â³ Downgrade ê³µê²© í…ŒìŠ¤íŠ¸
5. â³ íŒ¨ìŠ¤ì›Œë“œ íƒˆì·¨ ê²€ì¦

---
ìž‘ì„±ì¼: $(date '+%Y-%m-%d %H:%M:%S')
ìƒíƒœ: Step 1 ì§„í–‰ ì¤‘
