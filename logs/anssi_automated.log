INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=3062), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=3063), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=24), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=31), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=3068), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=12170), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=3067), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=3069), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=3070), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11433), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11498), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=15002), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=12908), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11512), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11513), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11432), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=3071), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=12745), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=3072), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=3073), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=16306), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=17605), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=23501), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=58), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=62), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=78), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=80), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=83), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11508), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11510), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=84), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=15957), requested parent node NumericNodeId(i=11715) does not exists
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=15958), requested parent node NumericNodeId(i=15957) does not exists
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=15959), requested parent node NumericNodeId(i=15957) does not exists
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=15960), requested parent node NumericNodeId(i=15957) does not exists
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=15961), requested parent node NumericNodeId(i=15957) does not exists
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=15962), requested parent node NumericNodeId(i=15957) does not exists
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=15963), requested parent node NumericNodeId(i=15957) does not exists
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=15964), requested parent node NumericNodeId(i=15957) does not exists
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=16134), requested parent node NumericNodeId(i=15957) does not exists
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=16135), requested parent node NumericNodeId(i=15957) does not exists
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=16136), requested parent node NumericNodeId(i=15957) does not exists
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=16314), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11214), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11202), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11215), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2341), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2342), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2343), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11285), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2344), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11304), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2346), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2347), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2348), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2349), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2350), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11286), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11287), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11305), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11306), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11288), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2351), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2352), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11307), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11308), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2355), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2357), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2358), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2359), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11505), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11506), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11507), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2360), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2361), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2362), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2363), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=2364), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11292), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11426), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11427), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11428), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.address_space:add_node: while adding node NumericNodeId(i=11429), requested parent node is null TwoByteNodeId(i=0) True
INFO:opcua.server.internal_server:Created internal session Internal
INFO:__main__:=== ANSSI OPC UA Server Started ===
INFO:__main__:Endpoint: opc.tcp://0.0.0.0:4850
INFO:__main__:Supported Security Modes: None, Sign, SignAndEncrypt
INFO:__main__:WARNING: This server allows plaintext credential transmission!
WARNING:opcua.server.server:Endpoints other than open requested but private key and certificate are not set.
INFO:opcua.server.internal_server:starting internal server
WARNING:opcua.server.binary_server_asyncio:Listening on 0.0.0.0:4850
INFO:__main__:Server running. Press Ctrl+C to stop...
tcpdump: data link type LINUX_SLL2
tcpdump: listening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes
0 packets captured
0 packets received by filter
0 packets dropped by kernel
tcpdump: data link type LINUX_SLL2
tcpdump: listening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes
0 packets captured
0 packets received by filter
0 packets dropped by kernel
================================================================================
ANSSI Scenario Automated Test
================================================================================

[1/6] Starting ANSSI OPC UA Server...
âœ“ Server started on port 4850

[2/6] Running Scenario A: Baseline (None mode - plaintext)...
âœ“ Scenario A captured

[3/6] Running Scenario B: Encrypted (SignAndEncrypt)...
âœ“ Scenario B captured

[4/6] Analyzing captures...

ðŸ“Š Checking Scenario A (Baseline) for plaintext credentials...
âœ— No plaintext found (may need deeper analysis)

ðŸ“Š Checking Scenario B (Encrypted) for plaintext credentials...
âœ“ No plaintext found (credentials properly encrypted)

[5/6] Generating analysis report...
âœ“ Report saved to /root/opcua-research/reports/anssi_analysis.txt

[6/6] Cleaning up...
âœ“ Server stopped

================================================================================
ANSSI Automated Test Complete!
================================================================================

Results saved in: /root/opcua-research/pcaps/anssi_scenario
Report: /root/opcua-research/reports/anssi_analysis.txt

To analyze in detail:
  wireshark /root/opcua-research/pcaps/anssi_scenario/scenario_*.pcap
  tshark -r /root/opcua-research/pcaps/anssi_scenario/scenario_a_baseline.pcap -Y 'opcua' -x
INFO:opcua.server.binary_server_asyncio:New connection from ('127.0.0.1', 57994)
INFO:opcua.server.uaprocessor:get endpoints request
INFO:opcua.server.internal_server:get endpoint
INFO:opcua.server.uaprocessor:sending get endpoints response
INFO:opcua.server.uaprocessor:Close session request
INFO:opcua.server.uaprocessor:Request to close non-existing session
INFO:opcua.server.uaprocessor:sending close session response
INFO:opcua.server.binary_server_asyncio:processor returned False, we close connection from ('127.0.0.1', 57994)
INFO:opcua.server.binary_server_asyncio:Lost connection from ('127.0.0.1', 57994), None
INFO:opcua.server.uaprocessor:Cleanup client connection: ('127.0.0.1', 57994)
INFO:opcua.server.binary_server_asyncio:New connection from ('127.0.0.1', 55502)
INFO:opcua.server.uaprocessor:get endpoints request
INFO:opcua.server.internal_server:get endpoint
INFO:opcua.server.uaprocessor:sending get endpoints response
INFO:opcua.server.uaprocessor:Close session request
INFO:opcua.server.uaprocessor:Request to close non-existing session
INFO:opcua.server.uaprocessor:sending close session response
INFO:opcua.server.binary_server_asyncio:processor returned False, we close connection from ('127.0.0.1', 55502)
INFO:opcua.server.binary_server_asyncio:Lost connection from ('127.0.0.1', 55502), None
INFO:opcua.server.uaprocessor:Cleanup client connection: ('127.0.0.1', 55502)
INFO:opcua.server.binary_server_asyncio:New connection from ('127.0.0.1', 35728)
INFO:opcua.server.uaprocessor:get endpoints request
INFO:opcua.server.internal_server:get endpoint
INFO:opcua.server.uaprocessor:sending get endpoints response
INFO:opcua.server.uaprocessor:Close session request
INFO:opcua.server.uaprocessor:Request to close non-existing session
INFO:opcua.server.uaprocessor:sending close session response
INFO:opcua.server.binary_server_asyncio:processor returned False, we close connection from ('127.0.0.1', 35728)
INFO:opcua.server.binary_server_asyncio:Lost connection from ('127.0.0.1', 35728), None
INFO:opcua.server.uaprocessor:Cleanup client connection: ('127.0.0.1', 35728)
INFO:opcua.server.binary_server_asyncio:New connection from ('127.0.0.1', 53468)
INFO:opcua.server.uaprocessor:get endpoints request
INFO:opcua.server.internal_server:get endpoint
INFO:opcua.server.uaprocessor:sending get endpoints response
INFO:opcua.server.uaprocessor:Create session request
INFO:opcua.server.internal_server:Created internal session ('127.0.0.1', 53468)
INFO:opcua.server.internal_server:Create session request
INFO:opcua.server.internal_server:get endpoint
INFO:opcua.server.uaprocessor:sending create session response
INFO:opcua.server.uaprocessor:Activate session request
INFO:opcua.server.internal_server:activate session
INFO:opcua.server.internal_server:Activated internal session ('127.0.0.1', 53468) for user User.Anonymous
INFO:opcua.server.uaprocessor:sending read response
INFO:opcua.server.uaprocessor:Close session request
INFO:opcua.server.internal_server:close session InternalSession(name:('127.0.0.1', 53468), user:User.Anonymous, id:NumericNodeId(i=11), auth_token:NumericNodeId(i=1001)) with subscriptions []
INFO:opcua.server.subscription_service:delete subscriptions: []
INFO:opcua.server.uaprocessor:sending close session response
INFO:opcua.server.binary_server_asyncio:processor returned False, we close connection from ('127.0.0.1', 53468)
INFO:opcua.server.binary_server_asyncio:Lost connection from ('127.0.0.1', 53468), None
INFO:opcua.server.uaprocessor:Cleanup client connection: ('127.0.0.1', 53468)
INFO:opcua.server.internal_server:close session InternalSession(name:('127.0.0.1', 53468), user:User.Anonymous, id:NumericNodeId(i=11), auth_token:NumericNodeId(i=1001)) with subscriptions []
INFO:opcua.server.subscription_service:delete subscriptions: []
